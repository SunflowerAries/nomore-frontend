(function(t){function e(e){for(var a,s,c=e[0],i=e[1],u=e[2],d=0,f=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a]);l&&l(e);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,c=1;c<n.length;c++){var i=n[c];0!==r[i]&&(a=!1)}a&&(o.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},r={app:0},o=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=i;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0f72":function(t,e){},1589:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("meta",{attrs:{charset:"utf-8"}}),n("title",[t._v("ShareDB Textarea")]),n("meta",{attrs:{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"}}),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12"}},[n("p",[t._v("Connection Status: "),n("span",{attrs:{id:"status-span"}})]),n("v-textarea",{attrs:{autofocus:"",outlined:"",name:"input-7-4",label:"Content",value:""}})],1)],1)],1)},r=[]},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-main",[n("router-view")],1)],1)},o=[],s={name:"App",components:{},data:function(){return{}}},c=s,i=n("2877"),u=n("6544"),l=n.n(u),d=n("7496"),f=n("f6c4"),m=Object(i["a"])(c,r,o,!1,null,null,null),h=m.exports;l()(m,{VApp:d["a"],VMain:f["a"]});var p=n("f309");a["a"].use(p["a"]);var v=new p["a"]({}),b=(n("b0c0"),n("b64b"),n("2f62")),g={type:null,message:null},w={success:function(t,e){var n=t.commit;n("success",e)},error:function(t,e){var n=t.commit;n("error",e)},clear:function(t){var e=t.commit;e("clear")}},k={success:function(t,e){t.type="alert-success",t.message=e},error:function(t,e){t.type="alert-danger",t.message=e},clear:function(t){t.type=null,t.message=null}},x={namespaced:!0,state:g,actions:w,mutations:k},y=(n("99af"),n("d3b7"),n("5530")),S=Object({NODE_ENV:"production",VUE_APP_API_URL:"http://localhost:3000",BASE_URL:"/"}),_=S.NODE_ENV,T=S.BASE_URL,O="http://localhost:3000";console.log(_,O,T);n("caad");var V=n("8c4f"),j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",{attrs:{justify:"center"}},[n("v-container",[n("v-list",{attrs:{rounded:""}},[n("v-list-item-group",{attrs:{color:"primary"}},t._l(t.docs,(function(e,a){return n("v-list-item",{key:a,attrs:{to:"/docs/"+e.docName}},[n("v-list-item-avatar",[n("v-icon",{class:"blue",attrs:{dark:""},domProps:{textContent:t._s("mdi-clipboard-text")}})],1),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e.docName)}}),n("v-list-item-subtitle",{domProps:{textContent:t._s(e.time)}})],1)],1)})),1)],1)],1),n("v-btn",{staticClass:"mx-2",staticStyle:{position:"fixed",bottom:"10%",right:"5%"},attrs:{fab:"",dark:"",color:"indigo"},on:{click:function(e){t.showDialog=!0}}},[n("v-icon",{attrs:{dark:""}},[t._v(" mdi-plus ")])],1),n("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v(" New Document ")]),n("v-textarea",{staticClass:"ma-3",attrs:{label:"Doc Name",hint:"",rows:"1",outlined:"",rounded:"","no-resize":"","auto-grow":"",rules:t.docNameRules,counter:"64"},model:{value:t.newDocName,callback:function(e){t.newDocName=e},expression:"newDocName"}}),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.newDocName="",t.showDialog=!1}}},[t._v(" Cancel ")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.newDoc()}}},[t._v(" Create ")])],1)],1)],1),n("v-snackbar",{attrs:{color:t.snackbarColor,timeout:t.snackbarTimeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbarText)+" "),n("v-btn",{attrs:{dark:"",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v(" Close ")])],1)],1)},C=[],D=(n("4160"),n("159b"),n("bc3a")),N=n.n(D),P={createDoc:E,getDocsName:I};function E(t){return new Promise((function(e,n){N.a.post("".concat(O,"/docs"),{docName:t},{headers:St()}).then((function(t){console.log(t),e(t.data)})).catch((function(t){return n(t)}))}))}function I(){var t={method:"GET",headers:St()};return console.log(t),fetch("".concat(O,"/docs"),t).then(R)}function R(t){return t.text().then((function(e){var n=e&&JSON.parse(e);if(!t.ok){t.status===_t&&location.reload(!0);var a=n&&n.message||t.statusText;return Promise.reject(a)}return n}))}var L=n("5a0c"),$=n.n(L),q=(n("a471"),n("4208")),A=n.n(q);function J(t){var e=$()(t).locale("zh-cn").fromNow();return e}$.a.extend(A.a);var M={data:function(){return{newDocName:"",docNameRules:[function(t){return!t||t.length<=64||"No more than 64 words"}],showDialog:!1,snackbar:"",snackbarColor:"",snackbarText:"",snackbarTimeout:2e3}},created:function(){this.getDocsInfo()},computed:Object(y["a"])(Object(y["a"])({},Object(b["b"])(["countDocs"])),{},{docs:function(){var t=[];return this.$store.state.docs.forEach((function(e){var n={time:J(e.createdAt)};t.push(Object(y["a"])(Object(y["a"])({},e),n))})),t}}),methods:{getDocsInfo:function(){var t=this;P.getDocsName().then((function(e){console.log(e),t.$store.commit("SET_DOCS",e)}),(function(t){console.log(t)}))},showSnackbar:function(t,e){this.snackbarColor=t,this.snackbarText=e,this.snackbar=!0},newDoc:function(){var t=this;null==this.newDocName?this.showSnackbar("error","Invalid Name"):(this.getDocsInfo(),P.createDoc(this.newDocName).then((function(e){e.message&&(t.showSnackbar("error",e.message),console.log(e))})),this.$router.push("/docs/".concat(this.newDocName)))}}},U=M,B=n("8336"),F=n("b0af"),G=n("99d9"),z=n("a523"),H=n("169a"),K=n("132d"),Q=n("8860"),W=n("da13"),X=n("8270"),Y=n("5d23"),Z=n("1baa"),tt=n("0fd9"),et=n("2db4"),nt=n("2fa4"),at=n("a844"),rt=Object(i["a"])(U,j,C,!1,null,null,null),ot=rt.exports;l()(rt,{VBtn:B["a"],VCard:F["a"],VCardActions:G["a"],VCardTitle:G["b"],VContainer:z["a"],VDialog:H["a"],VIcon:K["a"],VList:Q["a"],VListItem:W["a"],VListItemAvatar:X["a"],VListItemContent:Y["a"],VListItemGroup:Z["a"],VListItemSubtitle:Y["b"],VListItemTitle:Y["c"],VRow:tt["a"],VSnackbar:et["a"],VSpacer:nt["a"],VTextarea:at["a"]});var st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",[n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"10"}},[n("v-text-field",{attrs:{rules:[t.rules.required,t.rules.max],label:"Username"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"10"}},[n("v-text-field",{attrs:{"append-icon":t.showPassword?"mdi-eye":"mdi-eye-off",rules:[t.rules.required,t.rules.min,t.rules.max],type:t.showPassword?"text":"password",label:"Password"},on:{"click:append":function(e){t.showPassword=!t.showPassword}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),n("v-snackbar",{attrs:{color:t.snackbarColor,timeout:t.snackbarTimeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbarText)+" "),n("v-btn",{attrs:{dark:"",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v(" Close ")])],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"6",lg:"4"}},[n("v-row",{attrs:{justify:"center"}},[n("v-btn",{attrs:{color:"primary",large:"",dark:""},on:{click:t.login}},[t._v(" 登录 ")])],1)],1)],1),n("v-btn",{staticClass:"mx-2",staticStyle:{position:"fixed",bottom:"10%",right:"5%"},attrs:{fab:"",dark:"",color:"indigo"},on:{click:function(e){return t.$router.push("/register")}}},[n("v-icon",{attrs:{dark:""}},[t._v(" mdi-plus ")])],1)],1)],1)},ct=[],it={data:function(){return{showPassword:!1,username:"",password:"",rules:{required:function(t){return!!t||"Required."},min:function(t){return t.length>=6||"Min 6 characters"},max:function(t){return t.length<=24||"Max 24 characters"}},snackbar:"",snackbarColor:"",snackbarText:"",snackbarTimeout:2e3}},computed:Object(y["a"])({},Object(b["c"])(["user"])),methods:{disableLogin:function(){var t=null!==this.username&&this.username.length<=24,e=null!==this.password&&this.password.length>=6&&this.password.length<=24;return!t||!e},showSnackbar:function(t,e){this.snackbarColor=t,this.snackbarText=e,this.snackbar=!0},getDocsName:function(){P.getDocsName().then((function(t){console.log("docsname",t)})).catch((function(t){console.log(t)}))},login:function(){var t=this;if(this.disableLogin())this.showSnackbar("warning","输入格式错误");else{var e={username:this.username,password:this.password};Tt.login(e).then((function(e){e.message?t.showSnackbar("error",e.message):(t.$store.commit("SET_USER",e),t.getDocsName(),t.showSnackbar("success","欢迎回来"),setTimeout((function(){t.$router.push("docs")}),1e3))}))}}}},ut=it,lt=n("62ad"),dt=n("4bd4"),ft=n("8654"),mt=Object(i["a"])(ut,st,ct,!1,null,null,null),ht=mt.exports;l()(mt,{VBtn:B["a"],VCol:lt["a"],VContainer:z["a"],VForm:dt["a"],VIcon:K["a"],VRow:tt["a"],VSnackbar:et["a"],VTextField:ft["a"]});var pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",[n("v-container",{attrs:{fluid:""}},[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"6",md:"8",lg:"10"}},[n("v-text-field",{attrs:{rules:[t.rules.required,t.rules.max],label:"Username",hint:"阁下怎么称呼？"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"6",md:"8",lg:"10"}},[n("v-text-field",{attrs:{"append-icon":t.showPassword?"mdi-eye":"mdi-eye-off",rules:[t.rules.required,t.rules.min,t.rules.max],type:t.showPassword?"text":"password",label:"Password",hint:"6-24 characters",counter:""},on:{"click:append":function(e){t.showPassword=!t.showPassword}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-btn",{attrs:{color:"primary",large:"",dark:""},on:{click:t.register}},[t._v(" Register ")])],1),n("v-snackbar",{attrs:{color:t.snackbarColor,timeout:t.snackbarTimeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbarText)+" "),n("v-btn",{attrs:{dark:"",text:""},on:{click:function(e){t.snackbar=!1}}},[t._v(" Close ")])],1)],1)],1)},vt=[],bt={data:function(){return{showPassword:!1,showReEnter:!1,username:"",password:"",rules:{required:function(t){return!!t||"Required."},min:function(t){return t.length>=6||"Min 6 characters"},max:function(t){return t.length<=24||"Max 24 characters"}},snackbar:"",snackbarColor:"",snackbarText:"",snackbarTimeout:2e3}},computed:{disableRegister:function(){var t=null!==this.username&&this.username.length<=24,e=null!==this.password&&this.password.length>=6&&this.password.length<=24;return!t||!e}},methods:{showSnackbar:function(t,e){this.snackbarColor=t,this.snackbarText=e,this.snackbar=!0},register:function(){var t=this;if(this.disableRegister)this.showSnackbar("warning","输入格式有误");else{var e={username:this.username,password:this.password};Tt.register(e).then((function(e){console.log(e.message),e.message?t.showSnackbar("error",e.message):(t.showSnackbar("success","注册成功，跳转登录页面……"),setTimeout((function(){t.$router.push("login")}),1e3))}))}}}},gt=bt,wt=Object(i["a"])(gt,pt,vt,!1,null,null,null),kt=wt.exports;l()(wt,{VBtn:B["a"],VCol:lt["a"],VContainer:z["a"],VForm:dt["a"],VRow:tt["a"],VSnackbar:et["a"],VTextField:ft["a"]});var xt=n("aac4");a["a"].use(V["a"]);var yt=new V["a"]({mode:"history",routes:[{path:"/",component:ot},{path:"/login",component:ht},{path:"/register",component:kt},{path:"/docs/*",component:xt["default"]},{path:"/docs",component:ot},{path:"*",redirect:"/"}]});function St(){var t=JSON.parse(sessionStorage.getItem("user"));return t&&t.token?{Authorization:"Bearer "+t.token}:{}}yt.beforeEach((function(t,e,n){var a=["/login","/register","/docs","/docs"],r=!a.includes(t.path),o=sessionStorage.getItem("user");if(r&&!o)return n("/login");n()}));var _t=409,Tt={login:Ot,logout:Vt,register:jt,getAll:Ct,getById:Dt,update:Nt,delete:Pt};function Ot(t){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return fetch("".concat(O,"/auth/login"),e).then(Et).then((function(t){return t.token&&sessionStorage.setItem("user",JSON.stringify(t)),t}))}function Vt(){sessionStorage.removeItem("user")}function jt(t){var e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return console.log(O),fetch("".concat(O,"/auth/register"),e).then(Et)}function Ct(){var t={method:"GET",headers:St()};return fetch("".concat(O,"/auth"),t).then(Et)}function Dt(t){var e={method:"GET",headers:St()};return fetch("".concat(O,"/auth/").concat(t),e).then(Et)}function Nt(t){var e={method:"PUT",headers:Object(y["a"])(Object(y["a"])({},St()),{},{"Content-Type":"application/json"}),body:JSON.stringify(t)};return fetch("".concat(O,"/auth/").concat(t.id),e).then(Et)}function Pt(t){var e={method:"DELETE",headers:St()};return fetch("".concat(O,"/auth/").concat(t),e).then(Et)}function Et(t){return t.text().then((function(t){var e=t&&JSON.parse(t);return console.log(e),e}))}var It=JSON.parse(sessionStorage.getItem("user")),Rt=It?{status:{loggedIn:!0},user:It}:{status:{},user:null},Lt={login:function(t,e){var n=t.dispatch,a=t.commit,r=e.username,o=e.password;a("loginRequest",{username:r}),Tt.login(r,o).then((function(t){a("loginSuccess",t),yt.push("/docs")}),(function(t){a("loginFailure",t),n("alert/error",t,{root:!0})}))},logout:function(t){var e=t.commit;Tt.logout(),e("logout")},register:function(t,e){var n=t.dispatch,a=t.commit;a("registerRequest",e),Tt.register(e).then((function(t){a("registerSuccess",t),yt.push("/login"),setTimeout((function(){n("alert/success","Registration successful",{root:!0})}))}),(function(t){a("registerFailure",t),n("alert/error",t,{root:!0})}))}},$t={loginRequest:function(t,e){t.status={loggingIn:!0},t.user=e},loginSuccess:function(t,e){t.status={loggedIn:!0},t.user=e},loginFailure:function(t){t.status={},t.user=null},logout:function(t){t.status={},t.user=null},registerRequest:function(t,e){t.status={registering:!0}},registerSuccess:function(t,e){t.status={}},registerFailure:function(t,e){t.status={}}},qt={namespaced:!0,state:Rt,actions:Lt,mutations:$t},At=n("0e44");a["a"].use(b["a"]);var Jt=new b["a"].Store({state:{alert:x,account:qt,user:{id:"",username:"",token:""},docs:[]},mutations:{SET_USER:function(t,e){t.user.id=e.id,t.user.name=e.username,t.user.token=e.token},SET_DOCS:function(t,e){t.docs=e}},getters:{countDocs:function(t){return Object.keys(t.docs).length}},plugins:[Object(At["a"])({storage:window.sessionStorage,reducer:function(t){return{user:t.user,account:t.account,alter:t.alert,docs:t.docs}}})]});a["a"].config.productionTip=!1,new a["a"]({vuetify:v,router:yt,store:Jt,render:function(t){return t(h)}}).$mount("#app")},aac4:function(t,e,n){"use strict";var a=n("1589"),r=n("cfc4"),o=(n("c3a2"),n("d73a"),n("2877")),s=n("6544"),c=n.n(s),i=n("62ad"),u=n("a523"),l=n("0fd9"),d=n("a844"),f=Object(o["a"])(r["default"],a["a"],a["b"],!1,null,"69597d57",null);e["default"]=f.exports,c()(f,{VCol:i["a"],VContainer:u["a"],VRow:l["a"],VTextarea:d["a"]})},b70a:function(t,e,n){},c3a2:function(t,e,n){"use strict";n("ed4e")},cfc4:function(t,e,n){"use strict";var a=n("0f72"),r=n.n(a);e["default"]=r.a},d73a:function(t,e,n){"use strict";n("b70a")},ed4e:function(t,e,n){}});
//# sourceMappingURL=app.2c278b45.js.map